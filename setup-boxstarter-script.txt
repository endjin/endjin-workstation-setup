# General settings

# Comment-out/delete these lines if you like a more spartan Windows Explorer experience
Set-WindowsExplorerOptions -EnableShowHiddenFilesFoldersDrives `
                           -EnableShowProtectedOSFiles `
                           -EnableShowFileExtension

# WSL2 install steps
$checkWsl = & wsl --list
if ($checkWsl -imatch "Usage: wsl.exe") {
    Write-Host "Installing WSL..."
    wsl --install
}
#dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart
#dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart

#Invoke-WebRequest -Uri "https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi" -OutFile ./wsl_update_x64.msi
#& msiexec.exe /i $((Resolve-Path ./wsl_update_x64.msi).Path) /passive /l*v ./wsl2-install.log | Out-Null
#Write-Host "MSIExec code: $LASTEXITCODE"
#wsl --set-default-version 2


# Workaround issue with TEMP path getting polluted due to Boxstarter issue: https://github.com/chocolatey/boxstarter/issues/241
$cachePath = (Resolve-Path ([IO.Path]::Combine($env:USERPROFILE, 'AppData', 'Local', 'Temp', 'chocolatey'))).Path

# Install/upgrade packages using the configuration file
choco install --cacheLocation=$cachePath -y ./setup-chocolatey-packages.config
